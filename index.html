<!doctype HTML>
<style>body{font-family: Helvetica, Arial, Sans-Serif;}</style>
<script src="https://cdn.jsdelivr.net/npm/opentype.js"></script>
<script>
window.addEventListener('DOMContentLoaded', (event) => {
	const lines = document.querySelector('template').innerHTML.split(/\n/);
	const svgs = lines.map(e=>e.split(/\s+/)).filter(_=>_.length>1);
	[showFont,showImg].forEach(f=>f(svgs));
});
</script>
<nav>
	<a href=https://github.com/yne/svg>Github</a>
	<a href=editor.html>Editor</a>
</nav>



<h1>
SVG Image
</h1>

Cols:<input name=--col value=32 style=width:3em type=number onchange=grid.style.setProperty(this.name,this.value)>
Size:<select name=--size data-unit=px onchange=grid.style.setProperty(this.name,this.value+this.dataset.unit)><option>8<option selected>16<option>24<option>32</select>
Gap:<input name=--gap data-unit=px value=8 style=width:3em type=number onchange=grid.style.setProperty(this.name,this.value+this.dataset.unit)>
<a download href=picon.tar.bz2>download all</a>
<div id=grid style="
--col:32;
--size:16px;
--gap:8px;
display: grid;
grid-template-columns: repeat(var(--col), var(--size));
grid-gap: var(--gap);
margin: var(--gap);
"></div>

<script>
const el=(tag,attr)=>Object.keys(attr).reduce((e,a)=>(e.setAttribute(a,attr[a]),e),document.createElement(tag));
function showImg(svgs) {
	//t.map(name=>[name,name.split('-')[0]]).reduce((map,[name,group])=>(map[group]=(map[group]||[]).concat(name),map),{});
	const grid=document.getElementById('grid');
	svgs.map(([id,x,y,w,h,...g])=>grid.append(el('img',{src:`data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="${x} ${y} ${w} ${h}"><path d="${g.concat(' ')}"></path></svg>`,title:id})))
}
</script>



<h1>
OpenType Font
</h1>

<h2>Usage</h2>
<style>[lang]:before {content: attr(lang);font-size:8px;font-family:picon}</style>
Use the following CSS code <pre lang=.css>i{font-family:picon}</pre>
then in your HTML:<xmp lang=.html><i>ğŸ—”â™¥ğŸ§</i></xmp>
<p id=font style="word-break: break-all;font-family:picon"></p>

<script>
function normalize(p,w=16,h=16){
	let [x,y] = p.match(/[0-9.]+/g)
	return [x*2, h-y*2]
}
function showFont(svgs, size=16){
	var notdefGlyph = new opentype.Glyph({name: '.notdef', unicode: 0, advanceWidth: size, path: new opentype.Path()});
	const glyphs = [notdefGlyph, ...svgs.map((svg,i) => {
		const path = svg.slice(5).reduce((path,p)=>((p[0]=='M'?path.moveTo(...normalize(p)):path.lineTo(...normalize(p)),path)),new opentype.Path());
		return new opentype.Glyph({name: String.fromCharCode(i+60),unicode:i+60, advanceWidth: size, path});
	})]
	font = new opentype.Font({familyName: 'Picon', styleName: 'Medium', unitsPerEm: size, ascender: size, descender: -Number.EPSILON, glyphs});
	document.fonts.add(new FontFace(font.names.fontFamily.en, font.toArrayBuffer()));
	document.getElementById('font').innerText=Array.of(...Array(svgs.length)).map((_,i)=>String.fromCharCode(60+i)).join('')
}
</script>

<!-- <template> will be inserted bellow by CI-->

